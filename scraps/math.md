# math & theory

right triangle representation of vandermode determinant

for N=7

```text
(a-b)
(a-c)(b-c)
(a-d)(b-d)(c-d)
(a-e)(b-e)(c-e)(d-e)
(a-f)(b-f)(c-f)(d-f)(e-f)
(a-g)(b-g)(c-g)(d-g)(e-g)(f-g)
```

N can be expressed in terms of N-1 by just adding a row to the triangle

Three parts

- middle: rectangle

if N is odd

- half

## Recursion sequence

base case is at $N=2$.

Triangle method gives $\lceil\frac{N}{2}\rceil$ and $\lfloor\frac{N}{2}\rfloor$ recursion:

- depth: $\log_2N-1$.
- Max: $\log_2N-1 = 200 \Harr N = 2^{201}$.
- Not quadratic in terms of code size, but requires a lot of helpers for rects.

Row method gives $N-1$ recursion:

- $N-1$ depth.
- Max: $N-1 = 200 \Harr N = 201$.
- Fully linear, bounded set of helpers needed (alwas (<=64).1 cross differences)

201 is not enough, but we will never need anything even remotely close to $2^{201}$

actually i we could define a reasonable maximum at $N=10^6$

so we want $N=10^6$ to require 200 macro calls.

This means we have a "budget" of 200 recursive calls we need to exhaust.

log2(10^6) = 19.93.., almost 20

question: for each N, when to use row or triangle method so that the depth required to express N<=10^6 is always <= 200

then: check if continuous: does the required depth always grow with N? can we expect issues if we forget to account that

### idea 1: the logarithmic highway method

facts:

- our recursion limit is 200.
- triangle recursion should be as rare as possible in order to consume all our budget, since  they are longer to express and require more helpers.
- triangle recursion is more efficient at big N, (N/2, goes down faster), whereas row recursion is constant (always N-1)

## Triangle recursion method

General method to express vN:

we know vN is expressed by a triangle of height N-1

Split triangle in three parts

- bottom left rectangle of width floor(N/2) and height ceil(N/2)
- two smaller rectangle triangles:
  - of height N/2-1 if N is even
  - one of height floor((N-2)/2), one of height ceil((N-2)/2) if N is odd
- recursive calls:
  - $\lceil\frac{N}{2}\rceil$ and $\lfloor\frac{N}{2}\rfloor$

N=9

```text
(a-b)
(a-c)(b-c)
(a-d)(b-d)(c-d)
(a-e)(b-e)(c-e)(d-e)
(a-f)(b-f)(c-f)(d-f)(e-f)
(a-g)(b-g)(c-g)(d-g)(e-g)(f-g)
(a-h)(b-h)(c-h)(d-h)(e-h)(f-h)(g-h)
(a-i)(b-i)(c-i)(d-i)(e-i)(f-i)(g-i)(h-i)
```

$a\le$

Split:

4*5

```text
(a-e)(b-e)(c-e)(d-e)
(a-f)(b-f)(c-f)(d-f)
(a-g)(b-g)(c-g)(d-g)
(a-h)(b-h)(c-h)(d-h)
(a-i)(b-i)(c-i)(d-i)
```

$$
x_{W.H}=\prod_{w\in W}\prod_{h\in H}(w-h)
$$

v4

```text
(a-b)
(a-c)(b-c)
(a-d)(b-d)(c-d)
```

v5

```text
(e-f)
(e-g)(f-g)
(e-h)(f-h)(g-h)
(e-i)(f-i)(g-i)(h-i)
(e-i)(f-i)(g-i)(h-i)
```

Height = N-1

N=10:

```text
(a-b)
(a-c)(b-c)
(a-d)(b-d)(c-d)
(a-e)(b-e)(c-e)(d-e)
(a-f)(b-f)(c-f)(d-f)(e-f)
(a-g)(b-g)(c-g)(d-g)(e-g)(f-g)
(a-h)(b-h)(c-h)(d-h)(e-h)(f-h)(g-h)
(a-i)(b-i)(c-i)(d-i)(e-i)(f-i)(g-i)(h-i)
(a-j)(b-j)(c-j)(d-j)(e-j)(f-j)(g-j)(h-j)(i-j)
```

## mirroring a right triangle

```text
(a-b)
(a-c)(b-c)
```

```text
(c-b)(c-a)
     (b-a)
```

C-B

## a new representation

since our goal is to use helpers to minimize restating of terms

so each helper macro should use its terms as much as possible. the best function at doing that is vandermonde itself since it performs all unsorted pair differences

so drop cross differences (the xW_H business) it does not help.

instead build vN from multiples v of smaller N, effectively paving a right triangle from right triangles.

Group factors by distance between indices, i.e., all pairs separated by the same offset 

```text
Δ1: (a-b)(b-c)(c-d)(d-e)(e-f)(f-g)(g-h)(h-i)
Δ2: (a-c)(b-d)(c-e)(d-f)(e-g)(f-h)(g-i)
Δ3: (a-d)(b-e)(c-f)(d-g)(e-h)(f-i)
Δ4: (a-e)(b-f)(c-g)(d-h)(e-i)
Δ5: (a-f)(b-g)(c-h)(d-i)
Δ6: (a-g)(b-h)(c-i)
Δ7: (a-h)(b-i)
Δ8: (a-i)
```

Visually, it’s the same grid rotated 45°.
Each diagonal is length
N−k
N−k and could be generated by a helper d_k(length=N-k).
The product of all diagonals gives the same result.
The benefit: every term (a_i - a_{i+k}) appears exactly once, and you can cap diagonal length directly.

and it's self-similar

meaning that we can use vN as a primitive

but does mirroring work
