# Repository Guidelines

## Project Structure & Modules

- `src/` holds the TypeScript source; `cli.ts` is the entrypoint for the published CLI, while `index.ts` exposes the library API.
- `dist/` is generated by the TypeScript build and is the only code bundled in the npm package.
- `test/` contains unit tests (`*.test.ts`) run with `tsx --test`.
- `samples/` hosts pre-generated C headers and sample generators; keep it stable unless you intentionally refresh emitted artifacts.
- `scraps/` and `PAPER.MD` capture exploratory notes; avoid wiring production code to them.

## Build, Test, and Development

- Install deps: `npm install` (Node 18+ required).
- Build distributables: `npm run build` (runs `tsc -p tsconfig.build.json` into `dist/`).
- Run tests: `npm test` (executes `tsx --test` across `test/`).
- Smoke the CLI after building: `node dist/cli.js 1 4 -o build/uniqenum.h` (creates a small header for quick sanity checks).

## Coding Style & Naming

- ESM TypeScript. Prefer explicit return types on exported functions and keep public APIs in `index.ts`.
- Prettier rules are enforced (printWidth 120, single quotes, 4-space tabs for TS/JS). Format with `npx prettier -w src test`.
- Use lowerCamelCase for functions/variables, PascalCase for types, and ALL_CAPS for macro name templates and const enums.
- Keep generator code deterministic: avoid date-based seeds or unordered object iteration in emitted output.

## Testing Guidelines

- Add or extend `*.test.ts` in `test/`; mirror the filename of the module under test (e.g., `format.ts` → `format.test.ts`).
- Prefer functional tests that assert emitted strings/macros, not filesystem side effects; use fixtures in `samples/` only when necessary.
- Aim to cover both CLI parsing and pure functions; keep assertions minimal but precise.

## Commit & Pull Request Practices

- Commit messages are short, present-tense, and imperative (e.g., `generate headers`, `fix guard selection`).
- Before opening a PR, ensure `npm test` and `npm run build` pass and note any generator outputs you intentionally changed.
- In PR descriptions, include: purpose, key changes, testing done, and whether samples or generated headers were updated (with size/target notes if applicable).

## Safety & Configuration Tips

- The CLI writes files; prefer outputting to `build/` or a throwaway path while iterating to avoid polluting tracked headers.
- Large-range generation requires `--max-size` when streaming; directory mode (`--asdir`) shards automatically and adds include guards—mirror existing patterns when tweaking defaults.
